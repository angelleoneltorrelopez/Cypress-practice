name: Cypress test

on: push

jobs:
  cypress-run::
    runs-on: ubuntu-latest
    strategy:
      fail-fast: true
      matrix:
        containers: [1, 2, 3]

    steps:
      - name: Checkout
        uses: actions/checkout@v3
      
      - name: Install dependencies
      - run: npm ci
      
      - name: Run tests
        uses: cypress-io/github-action@v5
        with:
          record: true
          parallel: true
          command: npm run test:e2e
          
      - name: Allure Report
        uses: simple-elf/allure-report-action@v1.6
        with:
           allure_results: allure-results
           allure_report: docs
